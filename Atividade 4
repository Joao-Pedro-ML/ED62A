#include "AVL.h"


/*void imprimeNo(PtrNoAVL *a, int b) {

    FILE *arq2 = NULL;
    arq2 = fopen("saida.txt", "a");
    if(arq2 == NULL){
        printf("Erro ao abrir o arquivo de saida!!!\n");
    }
    int hesq = alturaAVL(&(*a)->left);
    int hdir = alturaAVL(&(*a)->right);
    int f = hdir - hesq;
    int i;
    for (i = 0; i < b; i++) {
        fprintf(arq2, "\t");
    }
    fprintf(arq2, "%i (%i),\n", (*a)->elemento.key, f);
    fclose(arq2);
}

void mostraArvore(PtrNoAVL *a, int b) {

    if((*a)->right != NULL){
        mostraArvore(&(*a)->right, b + 1);
    }
    if (a != NULL) {
        imprimeNo(&(*a), b);
    }
    
    if((*a)->left != NULL){
        mostraArvore(&(*a)->left, b + 1);
    }
}*/

int main(int argc, char** argv) {

    FILE *arq1 = NULL;
    if(argc < 3){
        printf("Numero insuficiente de argumentos!\n");
        exit(1);
    }
    arq1 = fopen(argv[1], "r");
    if (arq1 == NULL) {
        printf("Arquivo faltando!\n");
        exit(1);
    }
    PtrNoAVL a;
    objeto obj;
    iniciaAVL(&a);
    
    
    char c[100];
    char *aux;
    fgets(c,100,arq1);
    aux = strtok(c,",\n");
    while(aux != NULL){
        obj.key = atoi(aux);
        inserirAVL(&a,obj);
        aux = strtok(NULL,",\n");
    }
    FILE *arq2;
    arq2 = fopen(argv[2], "w");
    if (arq2 == NULL) {
        printf("Arquivo faltando!\n");
        exit(1);
    }
    fprintf(arq2, "(*)Antes\n");
    fclose(arq2);
    mostraArvore(&a, 1);
    int chave = 0;
    fgets(c,100,arq1);
    aux = strtok(c,",\n");
    while(aux != NULL){
        printf("%s\n", aux);
        chave = atoi(aux);
        remover(&a,chave);
        aux = strtok(NULL,",\n");
    }
    fclose(arq1);
    arq2 = fopen("saida.txt", "a");
    fprintf(arq2, "\n(*)Depois\n");
    fclose(arq2);
    mostraArvore(&a, 1);
    liberaAVL(&a);
    
    return (EXIT_SUCCESS);
}

